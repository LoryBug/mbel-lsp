§MBEL:6.0

[FOCUS]
@focus::MBEL6.0{Implementation-Phase1}
>completed::FullLSP{Lexer+Parser+Analyzer+Server+Features+Extension}✓
>completed::OpenCodeIntegration{SlashCommands+CustomTool}✓
>completed::MBEL6.0-Planning{Design-complete}✓
>completed::TDDAB#9::CrossRefLinks{14tokens,79tests,90.32%coverage}✓
>completed::TDDAB#10::SemanticAnchors{4tokens,37tests,90.85%coverage}✓
>completed::TDDAB#17::QueryService{23tests,398total,91.27%coverage}✓
>completed::TDDAB#18::QueryAPI-Anchors{19tests,417total,91.7%coverage}✓
>completed::TDDAB#19::QueryAPI-Dependencies{17tests,434total,92.22%coverage}✓

[DONE_V5]
✓ProjectSetup::MonorepoStructure{npmWorkspaces}
✓TypeScriptConfig::StrictMode{noAny,noImplicitReturns}
✓VitestConfig::Coverage%100{thresholds}
✓ESLintConfig::TypeScriptStrict
✓TDDAB#1::MbelLexer{61tests,%100coverage}
✓TDDAB#2::MbelParser{42tests,%91coverage}
✓TDDAB#3::MbelAnalyzer{48tests,%95coverage}
✓TDDAB#4::LspServer{34tests,%99coverage}
✓TDDAB#5::LspFeatures{29tests,%98coverage}
✓VSCodeExtension::mbel-vscode{textmate,languageClient}
✓Documentation::README{installation,improvements}
✓TDDAB#6::GoToDefinition{11tests,sections+attributes+versions}
✓TDDAB#7::FindReferences+WorkspaceSymbols{23tests}
✓TDDAB#8::LLMQueryMethods{11tests,semantic-queries}
✓FileExtension::.mbel.md{dual-support}
✓MBELSyntax::ConvertToSectionBrackets{[SECTION]instead-of-##}
✓OpenCodeSlashCommands::/mb,/mb-pending,/mb-recent
✓OpenCodeCustomTool::mbel-query{status,pending,completed,failed,critical,active,recent,all}
✓OpenCodeConfig::opencode.json{lsp-integration}

[DONE_V6_PLANNING]
✓MBEL6.0-PlanCreated{8blocks,147tests,~40tokens}
✓ArchitectureReview{Phase1-Lang,Phase2-Infra,Phase3-API,Phase4-Tools}
✓MemoryBankUpdated{systemPatterns,progress,activeContext}

[DONE_V6_PHASE1]
✓TDDAB#9::CrossRefLinks{14tokens,79tests,90.32%coverage}
  ↳lexer::10arrows{FILES,TESTS,DOCS,DECISIONS,RELATED,ENTRYPOINT,BLUEPRINT,DEPENDS,FEATURES,WHY}
  ↳lexer::2links{@feature,@task}+1struct{[...]}
  ↳ast::LinkDeclaration+FileRef+EntryPoint+LinkType+FileMarker+LineRange+ArrowClauseType
  ↳analyzer::17codes{MBEL-LINK-001→070,empty-name,invalid-chars,duplicates,glob,line-range,circular-dep,orphan}
  ↳tests::25lexer+22parser+32analyzer{338total}
  ↳files-modified::types.ts,lexer.ts,ast.ts,parser.ts,analyzer.ts,index.ts
  ↳files-created::lexer-links.test.ts,parser-links.test.ts,links-validation.test.ts
  ↳all-checks::build✓,lint✓,tests✓,coverage✓

✓TDDAB#10::SemanticAnchors{4tokens,37tests,90.85%coverage}
  ↳lexer::4tokens{ARROW_DESCRIZIONE,ANCHOR_ENTRY,ANCHOR_HOTSPOT,ANCHOR_BOUNDARY}
  ↳ast::AnchorDeclaration{anchorType,path,isGlob,description}
  ↳analyzer::5codes{MBEL-ANCHOR-001→011}
  ↳tests::15lexer+12parser+10analyzer{375total}
  ↳patterns::AnchorPrefixMap{likeARROW_OPERATORS},PositionWhitespaceDetection{pathvalidation},TypeFilteredStatementCheck
  ↳all-checks::build✓,lint✓,tests✓,coverage✓

[RECENT]
>updated::query-service.ts{getFeatureDependencies,getBlueprintProgress,3-helpers}
>updated::query-service.test.ts{+17tests,59total}
>updated::types.ts{FeatureDependencies,BlueprintProgress,TaskProgress,BlueprintSummary}
>completed::TDDAB#19{QueryAPI-Dependencies,434tests-total,92.22%coverage}
>updated::activeContext.mbel.md{FOCUS,RECENT,NEXT}
>updated::progress.mbel.md{TDDAB#19-complete}

[DECISIONS_V5]
§decision::TypeScriptOnly{noAny,strict}
§decision::Vitest>Jest{modern,faster}
§decision::ESM{type:module}
§decision::MonorepoWorkspaces{packages/*}
§decision::ImmutableAST{readonly-properties}
§decision::LeftAssociativeChains{A→B→C=(A→B)→C}
§decision::LSPDiagnosticCodes{16types,hierarchical}
§decision::ProjectReferences{composite:true}
§decision::IncrementalSync{TextDocumentSyncKind.Incremental}
§decision::NestedDocumentSymbols{attributesUnderSections}
§decision::SectionBrackets{[SECTION]not##Title}
§decision::OpenCodeIntegration{SlashCommands+CustomTool>MCP}

[DECISIONS_V6]
§decision::MBEL6.0-LLM-Native-Evolution
  ↳rationale::CodebaseBrain{semantic-storage,native-language-support}
  ↳approach::IncrementalPhases{Lang-Extensions→Infrastructure→API→Tools}
  ↳priority-order::1-CrossRefs,2-Anchors,3-LLM-API,3.5-QueryEngine,4-Decisions,5-HeatMap,6-Intents,Last-Integration
§decision::NewTokensStrategy
  ↳semantic-sections::5{§links,§anchors,§decisions,§heat,§intents}
  ↳operators::25{navigation,reference,analysis,intent}
  ↳prefixes::7{entry,hotspot,boundary,critical,stable,volatile,hot}
§decision::QueryEngineArchitecture
  ↳approach::DependencyGraph+SemanticIndex{buildfromAST}
  ↳queries::Semantic+Composite{support-LLM-integration}
§decision::LLMAPIStandalone
  ↳methods::7{getAnchor,getCrossRefs,getEditRisk,getImpactAnalysis,getDecisions,getIntent,getWorkContext}
  ↳design::RequestResponse{typed-inputs,rich-outputs}
§decision::LLM-Active-Navigation{2024-12-27}
  ↳rationale::MBEL-data-needs-queryable-API{not-just-readable-files}
  ↳requirements::getFeatureFiles,getFileFeatures,getEntryPoints,analyzeImpact,getOrphans
  ↳success-metrics::50%reduction-in-file-reads,zero-forgotten-files
  ↳design-doc::docs/LLM-NAVIGATION-IMPROVEMENTS.md

[NEXT]
!PRIORITY::LLM-Query-API{highest,enables-active-navigation}
✓TDDAB#17::QueryService{priority:P0,23tests,95.05%coverage}
  ↳methods::getFeatureFiles,getFileFeatures,getEntryPoints,getAnchors,getAnchorsByType,getAllFeatures
  ↳depends::TDDAB#9✓,#10✓
  ↳enables::LLM-active-codebase-navigation
✓TDDAB#18::QueryAPI-Anchors{priority:P1,19tests,96.94%coverage}
  ↳methods::analyzeImpact,getOrphanFiles
  ↳depends::TDDAB#17✓
  ↳enables::impact-analysis,orphan-detection,risk-assessment
✓TDDAB#19::QueryAPI-Dependencies{priority:P2,17tests,97.46%coverage}
  ↳methods::getFeatureDependencies,getBlueprintProgress
  ↳depends::TDDAB#17✓,#18✓
  ↳enables::dependency-graph,blueprint-tracking,circular-detection
?TDDAB#11::DecisionLog{priority:4,estimated-duration:2-3days}
  ↳depends::TDDAB#9✓,#10✓
?TDDAB#12::HeatMap{priority:5,estimated-duration:2-3days}
?TDDAB#20::GitIntegration{priority:P3,estimated-duration:3days}
  ↳methods::calculateHotspots,suggestAnchorUpdates
?TDDAB#21::NaturalLanguageQuery{priority:P3,estimated-duration:XL}

[BLOCKERS]
!OpenCodeLSP::AutoActivation{commands-work,lsp-not-auto-started}

[NOTES]
@note::TotalTests-V5::#259{lexer:61,parser:42,analyzer:48,server:34,features:74}
@note::TotalTests-V6-So-Far::#434{V5:259+TDDAB#9:79+TDDAB#10:37+TDDAB#17:23+TDDAB#18:19+TDDAB#19:17}
@note::TotalTests-Projected::#429{V5:259+V6:170}
@note::Coverage-Current::%92.22{TDDAB#19-full}
@note::Coverage-Target-V6::%90{exceeded}
@note::NewTokens::#40{sections:5,operators:25,prefixes:7,markers:3}
@note::NewASTNodes::#8{LinkNode,AnchorNode,DecisionNode,HeatNode,IntentNode,...}
@note::Phases::{Phase1:Lang-Ext,Phase2:Infra,Phase3:API,Phase4:Integration}
@note::PlanReference::tasks/MBEL-6.0-TDDAB-PLAN.md
