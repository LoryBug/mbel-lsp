{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "MBEL",
  "scopeName": "source.mbel",
  "patterns": [
    { "include": "#version" },
    { "include": "#section" },
    { "include": "#comment" },
    { "include": "#attribute" },
    { "include": "#temporal" },
    { "include": "#source" },
    { "include": "#operators" },
    { "include": "#metadata" },
    { "include": "#strings" },
    { "include": "#numbers" },
    { "include": "#identifiers" }
  ],
  "repository": {
    "version": {
      "patterns": [
        {
          "match": "^(§)(\\w+)(:)([0-9.]+)",
          "captures": {
            "1": { "name": "keyword.control.version.mbel" },
            "2": { "name": "entity.name.tag.mbel" },
            "3": { "name": "punctuation.separator.mbel" },
            "4": { "name": "constant.numeric.version.mbel" }
          }
        }
      ]
    },
    "section": {
      "patterns": [
        {
          "match": "^\\s*(\\[)([A-Z][A-Z0-9_]*)(\\])",
          "captures": {
            "1": { "name": "punctuation.definition.section.begin.mbel" },
            "2": { "name": "entity.name.section.mbel" },
            "3": { "name": "punctuation.definition.section.end.mbel" }
          }
        }
      ]
    },
    "comment": {
      "patterns": [
        {
          "begin": "\\(",
          "end": "\\)",
          "name": "comment.block.mbel",
          "patterns": [
            { "include": "#comment" }
          ]
        }
      ]
    },
    "attribute": {
      "patterns": [
        {
          "match": "(@)([a-zA-Z_][a-zA-Z0-9_]*)(::)",
          "captures": {
            "1": { "name": "keyword.operator.temporal.present.mbel" },
            "2": { "name": "variable.other.attribute.mbel" },
            "3": { "name": "keyword.operator.binding.mbel" }
          }
        }
      ]
    },
    "temporal": {
      "patterns": [
        {
          "match": "(>)([a-zA-Z_][a-zA-Z0-9_]*)(::)",
          "captures": {
            "1": { "name": "keyword.operator.temporal.past.mbel" },
            "2": { "name": "variable.other.attribute.mbel" },
            "3": { "name": "keyword.operator.binding.mbel" }
          }
        },
        {
          "match": "(\\?)([a-zA-Z_][a-zA-Z0-9_]*)(::)",
          "captures": {
            "1": { "name": "keyword.operator.temporal.future.mbel" },
            "2": { "name": "variable.other.attribute.mbel" },
            "3": { "name": "keyword.operator.binding.mbel" }
          }
        },
        {
          "match": "(≈)([a-zA-Z_][a-zA-Z0-9_]*)(::)",
          "captures": {
            "1": { "name": "keyword.operator.temporal.approximate.mbel" },
            "2": { "name": "variable.other.attribute.mbel" },
            "3": { "name": "keyword.operator.binding.mbel" }
          }
        }
      ]
    },
    "source": {
      "patterns": [
        {
          "match": "(©)([a-zA-Z_][a-zA-Z0-9_]*)",
          "captures": {
            "1": { "name": "keyword.operator.source.mbel" },
            "2": { "name": "entity.name.tag.author.mbel" }
          }
        }
      ]
    },
    "operators": {
      "patterns": [
        {
          "name": "keyword.operator.state.complete.mbel",
          "match": "✓"
        },
        {
          "name": "keyword.operator.state.failed.mbel",
          "match": "✗"
        },
        {
          "name": "keyword.operator.state.critical.mbel",
          "match": "!"
        },
        {
          "name": "keyword.operator.state.active.mbel",
          "match": "⚡"
        },
        {
          "name": "keyword.operator.relation.arrow.mbel",
          "match": "→|←|↔"
        },
        {
          "name": "keyword.operator.relation.binding.mbel",
          "match": "::"
        },
        {
          "name": "keyword.operator.relation.plus.mbel",
          "match": "\\+"
        },
        {
          "name": "keyword.operator.relation.minus.mbel",
          "match": "-"
        },
        {
          "name": "keyword.operator.quantifier.count.mbel",
          "match": "#"
        },
        {
          "name": "keyword.operator.quantifier.percent.mbel",
          "match": "%"
        },
        {
          "name": "keyword.operator.quantifier.range.mbel",
          "match": "~"
        },
        {
          "name": "keyword.operator.logic.and.mbel",
          "match": "&"
        },
        {
          "name": "keyword.operator.logic.or.mbel",
          "match": "\\|\\|"
        },
        {
          "name": "keyword.operator.logic.not.mbel",
          "match": "¬"
        },
        {
          "name": "keyword.operator.structure.alternative.mbel",
          "match": "\\|(?!\\|)"
        }
      ]
    },
    "metadata": {
      "patterns": [
        {
          "begin": "\\{",
          "end": "\\}",
          "name": "meta.block.metadata.mbel",
          "contentName": "string.unquoted.metadata.mbel",
          "beginCaptures": {
            "0": { "name": "punctuation.definition.metadata.begin.mbel" }
          },
          "endCaptures": {
            "0": { "name": "punctuation.definition.metadata.end.mbel" }
          },
          "patterns": [
            { "include": "#operators" },
            { "include": "#numbers" },
            { "include": "#identifiers" }
          ]
        },
        {
          "begin": "<",
          "end": ">",
          "name": "meta.block.variant.mbel",
          "contentName": "string.unquoted.variant.mbel",
          "beginCaptures": {
            "0": { "name": "punctuation.definition.variant.begin.mbel" }
          },
          "endCaptures": {
            "0": { "name": "punctuation.definition.variant.end.mbel" }
          },
          "patterns": [
            { "include": "#operators" },
            { "include": "#identifiers" }
          ]
        }
      ]
    },
    "strings": {
      "patterns": [
        {
          "name": "string.quoted.double.mbel",
          "begin": "\"",
          "end": "\"",
          "patterns": [
            {
              "name": "constant.character.escape.mbel",
              "match": "\\\\."
            }
          ]
        }
      ]
    },
    "numbers": {
      "patterns": [
        {
          "name": "constant.numeric.decimal.mbel",
          "match": "\\b[0-9]+\\.[0-9]+\\b"
        },
        {
          "name": "constant.numeric.integer.mbel",
          "match": "\\b[0-9]+\\b"
        }
      ]
    },
    "identifiers": {
      "patterns": [
        {
          "name": "variable.other.mbel",
          "match": "\\b[A-Za-z_][A-Za-z0-9_]*\\b"
        }
      ]
    }
  }
}
